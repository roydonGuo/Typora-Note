# Jvm最新面试题2022年，常见面试题及答案汇总


### 全部答案，更新日期：2022年5月18日，直接下载吧！

### 下载链接：[高清172份，累计 7701 页大厂面试题  PDF](https://gitee.com/souyunku/DevBooks/blob/master/docs/index.md)



### [1、谈谈动态年龄判断](https://gitee.com/souyunku/DevBooks/blob/master/docs/Jvm/Jvm最新面试题2021年，常见面试题及答案汇总.md#1谈谈动态年龄判断)  


**1、** 这里涉及到 -XX:TargetSurvivorRatio 参数，Survivor 区的目标使用率默认 50，即 Survivor 区对象目标使用率为 50%。

**2、** Survivor 区相同年龄所有对象大小的总和 (Survivor 区内存大小 * 这个目标使用率)时，大于或等于该年龄的对象直接进入老年代。

**3、** 当然，这里还需要考虑参数 -XX:MaxTenuringThreshold 晋升年龄最大阈值


### [2、类初始化的情况有哪些？](https://gitee.com/souyunku/DevBooks/blob/master/docs/Jvm/Jvm最新面试题2021年，常见面试题及答案汇总.md#2类初始化的情况有哪些)  


1.
遇到 `new`、`getstatic`、`putstatic` 或 `invokestatic` 字节码指令时，还未初始化。典型场景包括 new 实例化对象、读取或设置静态字段、调用静态方法。

2.
对类反射调用时，还未初始化。

3.
初始化类时，父类还未初始化。

4.
虚拟机启动时，会先初始化包含 main 方法的主类。

5.
使用 JDK7 的动态语言支持时，如果 MethodHandle 实例的解析结果为指定类型的方法句柄且句柄对应的类还未初始化。

6.
口定义了默认方法，如果接口的实现类初始化，接口要在其之前初始化。

7.
其余所有引用类型的方式都不会触发初始化，称为被动引用。被动引用实例：① 子类使用父类的静态字段时，只有父类被初始化。② 通过数组定义使用类。③ 常量在编译期会存入调用类的常量池，不会初始化定义常量的类。

8.
接口和类加载过程的区别：初始化类时如果父类没有初始化需要初始化父类，但接口初始化时不要求父接口初始化，只有在真正使用父接口时（如引用接口中定义的常量）才会初始化。



### [3、GC 是什么？为什么要有 GC？](https://gitee.com/souyunku/DevBooks/blob/master/docs/Jvm/Jvm最新面试题2021年，常见面试题及答案汇总.md#3gc-是什么为什么要有-gc)  


GC 是垃 圾收 集的 意思 ，内存 处理 是编 程人 员容 易出 现问 题的 地方 ，忘记 或者 错误的内 存回 收会 导致 程序 或系 统的 不稳 定甚 至崩 溃， Java 提供 的 GC 功能 可以 自动监测 对象 是否 超过 作用 域从 而达 到自 动回 收内 存的 目的 ，Java 语言 没有 提供 释放已分配内存的 显示 操作 方法 。Java 程序 员不 用担 心内 存管 理， 因为 垃圾 收集 器会自动 进行 管理 。要 请求 垃圾 收集 ，可 以调 用下 面的 方法 之一 ：System.gc() 或Runtime.getRuntime().gc() ，但 JVM 可以 屏蔽 掉线 示的 垃圾 回收 调用 。

垃圾回收可以有效的防止内存泄露，有效的使用可以使用的内存。垃圾回收器通常是作为一个单独的低优先级的线程运行，不可预知的情况下对内存堆中已经死亡的或者长时间没有使用的对象进行清除和回收，程序员不能实时的调用垃圾回收器对某个对象或所有对象进行垃圾回收。在 Java 诞生初期，垃圾回收是 Java最大的亮点之一，因为服务器端的编程需要有效的防止内存泄露问题，然而时过境迁，如今 Java 的垃圾回收机制已经成为被诟病的东。移动智能终端用户通常觉得 iOS 的系统比 Android 系统有更好的用户体验，其中一个深层次的原因就在于 Android 系统中垃圾回收的不可预知性。


### [4、MinorGC，MajorGC、FullGC都什么时候发生？](https://gitee.com/souyunku/DevBooks/blob/master/docs/Jvm/Jvm最新面试题2021年，常见面试题及答案汇总.md#4minorgcmajorgcfullgc都什么时候发生)  


MinorGC在年轻代空间不足的时候发生，MajorGC指的是老年代的GC，出现MajorGC一般经常伴有MinorGC。

FullGC有三种情况。

**1、** 当老年代无法再分配内存的时候

**2、** 元空间不足的时候

**3、** 显示调用System.gc的时候。另外，像CMS一类的垃圾回收器，在MinorGC出现promotion failure的时候也会发生FullGC


### [5、Java的双亲委托机制是什么？](https://gitee.com/souyunku/DevBooks/blob/master/docs/Jvm/Jvm最新面试题2021年，常见面试题及答案汇总.md#5java的双亲委托机制是什么)  


它的意思是，除了顶层的启动类加载器以外，其余的类加载器，在加载之前，都会委派给它的父加载器进行加载。这样一层层向上传递，直到祖先们都无法胜任，它才会真正的加载。

Java默认是这种行为。当然Java中也有很多打破双亲行为的骚操作，比如SPI（JDBC驱动加载），OSGI等。


### [6、在 Java 中，对象什么时候可以被垃圾回收？](https://gitee.com/souyunku/DevBooks/blob/master/docs/Jvm/Jvm最新面试题2021年，常见面试题及答案汇总.md#6在-java-中对象什么时候可以被垃圾回收)  


当对象对当前使用这个对象的应用程序变得不可触及的时候，这个对象就可以被回收了。


### [7、有哪些打破了双亲委托机制的案例？](https://gitee.com/souyunku/DevBooks/blob/master/docs/Jvm/Jvm最新面试题2021年，常见面试题及答案汇总.md#7有哪些打破了双亲委托机制的案例)  


**1、** Tomcat可以加载自己目录下的class文件，并不会传递给父类的加载器。

**2、** Java的SPI，发起者是 `BootstrapClassLoader`， `BootstrapClassLoader`已经是最上层的了。它直接获取了 `AppClassLoader`进行驱动加载，和双亲委派是相反的。。


### [8、JVM 年轻代到年老代的晋升过程的判断条件是什么呢？](https://gitee.com/souyunku/DevBooks/blob/master/docs/Jvm/Jvm最新面试题2021年，常见面试题及答案汇总.md#8jvm-年轻代到年老代的晋升过程的判断条件是什么呢)  


**1、** 部分对象会在From和To区域中复制来复制去,如此交换15次(由JVM参数MaxTenuringThreshold决定,这个参数默认是15),最终如果还是存活,就存入到老年代。

**2、** 如果对象的大小大于Eden的二分之一会直接分配在old，如果old也分配不下，会做一次majorGC，如果小于eden的一半但是没有足够的空间，就进行minorgc也就是新生代GC。

**3、** minor gc后，survivor仍然放不下，则放到老年代

**4、** 动态年龄判断 ，大于等于某个年龄的对象超过了survivor空间一半 ，大于等于某个年龄的对象直接进入老年代


### [9、JVM 数据运行区，哪些会造成 OOM 的情况？](https://gitee.com/souyunku/DevBooks/blob/master/docs/Jvm/Jvm最新面试题2021年，常见面试题及答案汇总.md#9jvm-数据运行区哪些会造成-oom-的情况)  


除了数据运行区，其他区域均有可能造成 OOM 的情况。

**堆溢出：**java.lang.OutOfMemoryError: Java heap space

**栈溢出：**java.lang.StackOverflowError

**永久代溢出：**java.lang.OutOfMemoryError: PermGen space


### [10、JVM 类加载机制](https://gitee.com/souyunku/DevBooks/blob/master/docs/Jvm/Jvm最新面试题2021年，常见面试题及答案汇总.md#10jvm-类加载机制)  


JVM 类加载机制分为五个部分：加载，验证，准备，解析，初始化。

**加载**

加载是类加载过程中的一个阶段， 这个阶段会在内存中生成一个代表这个类的 java.lang.Class 对象， 作为方法区这个类的各种数据的入口。注意这里不一定非得要从一个 Class 文件获取，这里既可以从 ZIP 包中读取（比如从 jar 包和 war 包中读取），也可以在运行时计算生成（动态代理），也可以由其它文件生成（比如将 JSP 文件转换成对应的 Class 类）。

**验证**

这一阶段的主要目的是为了确保 Class 文件的字节流中包含的信息是否符合当前虚拟机的要求，并且不会危害虚拟机自身的安全。

**准备**

准备阶段是正式为类变量分配内存并设置类变量的初始值阶段，即在方法区中分配这些变量所使用的内存空间。注意这里所说的初始值概念，比如一个类变量定义为：

实际上变量 v 在准备阶段过后的初始值为 0 而不是 8080， 将 v 赋值为 8080 的 put static 指令是程序被编译后， 存放于类构造器方法之中。

**但是注意如果声明为：**

public static final int v = 8080;

在编译阶段会为 v 生成 ConstantValue 属性，在准备阶段虚拟机会根据 ConstantValue 属性将 v赋值为 8080。

**解析**

解析阶段是指虚拟机将常量池中的符号引用替换为直接引用的过程。符号引用就是 class 文件中的

public static int v = 8080;

实际上变量 v 在准备阶段过后的初始值为 0 而不是 8080， 将 v 赋值为 8080 的 put static 指令是程序被编译后， 存放于类构造器方法之中。但是注意如果声明为：

在编译阶段会为 v 生成 ConstantValue 属性，在准备阶段虚拟机会根据 ConstantValue 属性将 v赋值为 8080。

**解析**

解析阶段是指虚拟机将常量池中的符号引用替换为直接引用的过程。符号引用就是 class 文件中的

public static final int v = 8080;

在编译阶段会为 v 生成 ConstantValue 属性，在准备阶段虚拟机会根据 ConstantValue 属性将 v赋值为 8080。

**解析**

解析阶段是指虚拟机将常量池中的符号引用替换为直接引用的过程。符号引用就是 class 文件中的：

**1、** CONSTANT_Class_info

**2、** CONSTANT_Field_info

**3、** CONSTANT_Method_info

等类型的常量。

**符号引用**

符号引用与虚拟机实现的布局无关， 引用的目标并不一定要已经加载到内存中。各种虚拟机实现的内存布局可以各不相同，但是它们能接受的符号引用必须是一致的，因为符号引用的字面量形式明确定义在 Java 虚拟机规范的 Class 文件格式中。

**直接引用**

直接引用可以是指向目标的指针，相对偏移量或是一个能间接定位到目标的句柄。如果有了直接引用，那引用的目标必定已经在内存中存在。

**初始化**

初始化阶段是类加载最后一个阶段，前面的类加载阶段之后，除了在加载阶段可以自定义类加载器以外，其它操作都由 JVM 主导。到了初始阶段，才开始真正执行类中定义的 Java 程序代码。

**类构造器**

初始化阶段是执行类构造器方法的过程。方法是由编译器自动收集类中的类变量的赋值操作和静态语句块中的语句合并而成的。虚拟机会保证子方法执行之前，父类的方法已经执行完毕， 如果一个类中没有对静态变量赋值也没有静态语句块，那么编译器可以不为这个类生成()方法。

**注意以下几种情况不会执行类初始化：**

**1、** 通过子类引用父类的静态字段，只会触发父类的初始化，而不会触发子类的初始化。

**2、** 定义对象数组，不会触发该类的初始化。

**3、** 常量在编译期间会存入调用类的常量池中，本质上并没有直接引用定义常量的类，不会触发定义常量所在的类。

**4、** 通过类名获取 Class 对象，不会触发类的初始化。

**5、** 通过 Class.forName 加载指定类时，如果指定参数 initialize 为 false 时，也不会触发类初始化，其实这个参数是告诉虚拟机，是否要对类进行初始化。

**6、** 通过 ClassLoader 默认的 loadClass 方法，也不会触发初始化动作。


### 11、字符串常量存放在哪个区域？
### 12、对象的访问方式有哪些？
### 13、说一下 JVM 调优的工具？
### 14、对象分配内存是否线程安全？
### 15、什么时候会造成堆外内存溢出？
### 16、你都用过G1垃圾回收器的哪几个重要参数？
### 17、双亲委派
### 18、Parallel Old 收集器（多线程标记整理算法）
### 19、Java 程序是怎样运行的？
### 20、请解释StackOverflowError和OutOfMemeryError的区别？
### 21、分区收集算法
### 22、串行（serial）收集器和吞吐量（throughput）收集器的区别是什么？
### 23、栈帧都有哪些数据？
### 24、对象在哪块内存分配？
### 25、运行时常量池溢出的原因？
### 26、safepoint 是什么？
### 27、JVM调优命令有哪些？
### 28、你说你做过JVM参数调优和参数配置，请问如何查看JVM系统默认值
### 29、Java 中会存在内存泄漏?简述一下
### 30、对象是怎么从年轻代进入老年代的？
### 31、什么情况下会发生栈内存溢出？





## [全部答案，更新日期：2022年5月18日，直接下载吧！](https://gitee.com/souyunku/DevBooks/blob/master/docs/daan.md)

### 下载链接：[全部答案，整理好了](https://gitee.com/souyunku/DevBooks/blob/master/docs/daan.md)




## [新增：高清PDF：172份，7701页，最新整理](https://gitee.com/souyunku/DevBooks/blob/master/docs/daan.md)




